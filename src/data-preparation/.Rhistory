}
retweet(2020)
View(blm_merged)
print(sum(blm_merged[blm_merged$retweet & blm_merged$year == 'year']))
retweet <- function(year){
print(sum(blm_merged[blm_merged$retweet & blm_merged$year == year]))
}
retweet(2020)
sum(blm_merged[blm_merged$year == 2020,]$retweet)
retweet <- (blm_merged[blm_merged$year == 2020,]$retweet)
retweet
sum(blm_merged[blm_merged$year == 2020,]$retweet, na.rm = T)
retweet <- function(year){
print(sum(blm_merged[blm_merged$year == "year",]$retweet, na.rm = T)
}
retweet <- function(year){
print(sum(blm_merged[blm_merged$year == "year",]$retweet, na.rm = T))
}
retweet(2020)
print(sum(blm_merged[blm_merged$year == 'year',]$retweet, na.rm = T))
retweet <- function(year){
print(sum(blm_merged[blm_merged$year == 'year',]$retweet, na.rm = T))
}
retweet(2020)
retweet <- function(year){
print(sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
}
retweet(2020)
retwet(2021)
retweet(2021)
RLR <- function(year){
print(sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)
RLR <- function(year){
retweet = (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like = (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply = (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)
RLRdata2020 <- as.data.frame(RLR(2020))
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <-  (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
df <- data.frame(retweet, like, reply)
}
RLR(2021)
RLR(2021)
RLR <- function(year){
print(sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2021)
rlr2021 < -RLR(2021)
rlr2021 <- RLR(2021)
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
rlr2021 <- RLR(2021)
rlr2021 <- as.data.frame(RLR(2021))
View(rlr2021)
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
df = data.FRAME(retweet, like, reply)
return(df)
}
RLR(2020)
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
df = as.data.frame(retweet, like, reply)
return(df)
}
RLR(2020)
RLR <- function(year){
df$retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
df$like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
df$reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
df = as.data.frame(retweet, like, reply)
return(df)
}
RLR(2020)
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T)),
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
df = as.data.frame(retweet, like, reply)
return(df)
}
RLR(2020)
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
df = as.data.frame(retweet = (retweet), like = (like), reply = (reply))
return(df)
}
RLR(2020)
RLR(2020)[retweet]
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)[retweet]
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)[retweet,]
RLR(2020)[1]
RLR(2020)[0]
RLR(2020)[3]
RLR <- function(year){
print(sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)
RLR <- function(year){
retwewet = print(sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like = print(sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply = print(sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)
RLR(2020)[retweet]
RLR(2020)[,retweet]
RLR(2020)(retweet)
tweets <- blm_merged %>%
select(text) %>%
unnest_tokens(word, text)
library(rtweet)
library(tidyr)
library(ggplot.multistats)
library(ggplot2)
library(forestmangr)
library(syuzhet)
library(tidyverse)
library(readxl) # read excel
library(tibble) # tobble dataframe
library(dplyr) # piping
library(stringr) # character manipulation
library(tidytext)
library(tokenizers)
library(stopwords)
library(lobstr)
library(glue)
tweets <- blm_merged %>%
select(text) %>%
unnest_tokens(word, text)
tweets <- tweets %>%
anti_join(get_stopwords(language = "nl", source = "snowball"))
tweets <- function(year){
tweets <- blm_merged[blm_merged$year == year] %>%
select(text) %>%
unnest_tokens(word, text)
tweets <- tweets %>%
anti_join(get_stopwords(language = "nl", source = "snowball"))
}
tweets(2020)
tweets <- function(year){
tweets <- blm_merged[blm_merged$year == year,] %>%
select(text) %>%
unnest_tokens(word, text)
tweets <- tweets %>%
anti_join(get_stopwords(language = "nl", source = "snowball"))
}
tweets(2020)
histogram_tweets <- function(year){
tweets(year) %>% # gives you a bar chart of the most frequent words found in the tweets
count(word, sort = TRUE) %>%
top_n(15) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_col() +
xlab(NULL) +
coord_flip() +
labs(y = "Count",
x = "Unique words",
title = "Most frequent words found in the tweets of #BLM",
subtitle = "Stop words removed from the list")
}
#making a histogram
histogram_tweets <- function(year){
tweets(year) %>% # gives you a bar chart of the most frequent words found in the tweets
count(word, sort = TRUE) %>%
top_n(15) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_col() +
xlab(NULL) +
coord_flip() +
labs(y = "Count",
x = "Unique words",
title = "Most frequent words found in the tweets of #BLM",
subtitle = "Stop words removed from the list")
}
histogram_tweets(2020)
histogram_tweets(2021)
histogram_tweets(2020)
histogram_tweets(2020)
histogram_tweets(2021)
histogram_tweets(2020)
histogram_tweets(2021)
histogram_tweets(2020)
sentiment <- function(year){
tweets_sentiment <- iconv(tweets(year), from="UTF-8", to="ASCII", sub="")
# removing retweets, in case needed
tweets_sentiment <-gsub("(RT|via)((?:\\b\\w*@\\w+)+)","",tweets_sentiment)
# removing mentions, in case needed
tweets_sentiment <-gsub("@\\w+","",tweets_sentiment)
ew_sentiment<-get_nrc_sentiment((tweets_sentiment))
sentimentscores<-data.frame(colSums(ew_sentiment[,]))
names(sentimentscores) <- "Score"
sentimentscores <- cbind("sentiment"=rownames(sentimentscores),sentimentscores)
rownames(sentimentscores) <- NULL
ggplot(data=sentimentscores,aes(x=sentiment,y=Score))+
geom_bar(aes(fill=sentiment),stat = "identity")+
theme(legend.position="none")+
xlab("Sentiments")+ylab("Scores")+
ggtitle("Total sentiment based on scores 2020")+
theme_minimal()
}
sentiment(2020)
sentiment(2021)
sentiment(2020)
sentiment(2021)
retweet_location <- function(year){
ggplot(data = blm_merged[blm_merged$year == year,]) +
geom_point(mapping = aes(x = retweet, y = location))
}
retweet_location(2020)
retweet_location(2011)
retweet_location(2021)
retweet_location(2020)
retweet_datetime <- function(year){
ggplot(data = blm2020) +
geom_point(mapping = aes(x = retweet, y = datetime), color = "blue")
}
retweet_datetime(2020)
retweet_date <- function(year){
ggplot(data = blm2020) +
geom_point(mapping = aes(x = retweet, y = date), color = "blue")
}
retweet_datetime(2020)
retweet_date(2020)
retweet_date(2021)
retweet_date(2021)
retweet_date(2020)
retweet_date(2021)
retweet_date <- function(year){
ggplot(data = bl
retweet_date(2021)
retweet_date(2020)
retweet_date(2021)
retweet_date <- function(year){
ggplot(data = blm_merged[blm_merged$year == year]) +
geom_point(mapping = aes(x = retweet, y = date), color = "blue")
}
retweet_date(2021)
retweet_date <- function(year){
ggplot(data = blm_merged[blm_merged$year == year,]) +
geom_point(mapping = aes(x = retweet, y = date), color = "blue")
}
retweet_date(2021)
followers_friends <- function(year){
ggplot(data = blm_merged[blm_merged$year == year,]) +
geom_point(mapping = aes(x = user_amount_followers, y = user_amount_friends), color = "blue")
}
followers_friends(2020)
followers_friends(2021)
status_location(2020)
status_location <- function(year){
ggplot(data = blm_merged[blm_merged$year == year,]) +
geom_point(mapping = aes(x = user_amount_status, y = location), color = "blue")
}
status_location(2020)
status_location(2021)
oneway_anova <- function(year){
oneway <- aov(sentiment ~ source_tweet , data = blm_merged[blm_merged$year == year,])
print(summary(oneway))
}
oneway_anova(2020)
oneway_anova <- function(year){
oneway <- aov(sentiment ~ source_tweet , data = blm_merged[blm_merged$year == year,])
}
oneway_anova(2020)
oneway_anova <- function(year){
oneway <- aov(sentiment(year) ~ source_tweet , data = blm_merged[blm_merged$year == year,]
}
oneway_anova <- function(year){
oneway <- aov(sentiment(year) ~ source_tweet , data = blm_merged[blm_merged$year == year,])
}
oneway_anova(2020)
oneway <- aov(sentiment ~ source_tweet , data = blm_merged[blm_merged$year == year,])
oneway_anova <- function(year){
oneway <- aov(sentiment ~ source_tweet , data = blm_merged[blm_merged$year == year,])
}
oneway_anova(2020)
oneway_anova <- function(year){
oneway <- aov(sentiment(year) ~ source_tweet , data = blm_merged[blm_merged$year == year,])
}
oneway_anova(2020)
oneway_anova <- function(year){
oneway <- aov(sentimentscores ~ source_tweet , data = blm_merged[blm_merged$year == year,])
}
oneway_anova(2020)
oneway <- aov(sentimentscores(year) ~ source_tweet , data = blm_merged[blm_merged$year == year,])
one.way <- aov(source_tweet ~ ., data = blm_merged[blm_merged$year == 2020,])
retweets_glm <-glm(retweet ~ ., data=blm_merged[blm_merged$year == 2020,])
retweets_glm <-glm(retweet ~ ., data=blm_merged[blm_merged$year == 2021,])
RLR(2020) / sum(RLR(2020))
RLR(2020)
RLR(2021)
RLR <- function(year){
print(sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
print(sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLR(2020)
RLR(2021)
RLR <- function(year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
RRLdata <- data.frame(retweet = retweet, like = like, reply = reply)
}
RLR(2020)
View(RLRdata2020)
RLR <- function(year){
RLRdata < - data.frame()
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
RLRdata <- data.frame(retweet = retweet, like = like, reply = reply)
return(RLRdata)
}
RLR(2020)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- RLRdata(retweet = retweet, like = like, reply = reply)
return(RLRdata)
}
RLR(2020)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- RLRdata(retweet, like, reply)
return(RLRdata)
}
RLR(2020)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- data.frame(retweet, like, reply)
return(RLRdata)
}
RLR(2020)
RLR(2021)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- data.frame(retweet, like, reply)
return(RLRdata)
}
RLR(2020)
RLR(2021)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- data.frame(retweet, like, reply)
return(RLRdata)
}
RLR(2020)
rlrdata2020 <- RLR(2020)
View(rlrdata2020)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- data.frame(retweet, like, reply)
return(RLRdata)
}
RLRdata2020 <- RLR(2020)
RLRdata2021 <- RLR(2021)
View(RLRdata2020)
View(rlrdata2020)
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- data.frame(category=c("Retweet", "Like", "Reply"), count = c(retweet, like, reply))
return(RLRdata)
}
RLRdata2020 <- RLR(2020)
View(RLRdata2020)
RLRdata2021 <- RLR(2021)
RLR_plot <- function(year){
RLR(year)$fraction = RLR(year)$count / sum(RLR(year)$count)
RLR(year)$percentage = RLR(year)$count / sum(RLR(year)$count) * 100
RLR(year)$ymax = cumsum(RLR(year)$fraction)
RLR(year)$ymin = c(0, head(RLR(year)$ymax, n=-1))
#Rounding up
RLR(year)<- round_df(RLR(year), 2)
# Specify what the legend should say
Type_of_Tweet <- paste(RLR(year)$category, RLR(year)$percentage, "%")
ggplot(RLR(year), aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Type_of_Tweet)) +
geom_rect() +
coord_polar(theta="y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "right")
}
RLR_plot(2020)
RLR_plot(2021)
graph <- function(year){
RLR(year)$fraction = RLR(year)$count / sum(RLR(year)$count)
RLR(year)$percentage = RLR(year)$count / sum(RLR(year)$count) * 100
RLR(year)$ymax = cumsum(RLR(year)$fraction)
RLR(year)$ymin = c(0, head(RLR(year)$ymax, n=-1))
#Rounding up
RLR(year)<- round_df(RLR(year), 2)
# Specify what the legend should say
Type_of_Tweet <- paste(RLR(year)$category, RLR(year)$percentage, "%")
ggplot(RLR(year), aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Type_of_Tweet)) +
geom_rect() +
coord_polar(theta="y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "right")
}
graph(2021)
RLR2020
RLR(2020)
RLRdata2020$fraction = RLRdata2020$count / sum(RLRdata2020$count)
RLRdata2020$percentage = RLRdata2020$count / sum(RLRdata2020$count) * 100
RLRdata2020$ymax = cumsum(RLRdata2020$fraction)
RLRdata2020$ymin = c(0, head(RLRdata2020)$ymax, n=-1))
RLRdata2020$fraction = RLRdata2020$count / sum(RLRdata2020$count)
RLRdata2020$percentage = RLRdata2020$count / sum(RLRdata2020$count) * 100
RLRdata2020$ymax = cumsum(RLRdata2020$fraction)
RLRdata2020$ymin = c(0, head(RLRdata2020)$ymax, n=-1)
RLRdata2020 <- RLR(2020)
RLRdata2020
RLRdata2021 <- RLR(2021)
RLRdata2021
RLRdata2020$fraction = RLRdata2020$count / sum(RLRdata2020$count)
RLRdata2020$percentage = RLRdata2020$count / sum(RLRdata2020$count) * 100
RLRdata2020$ymax = cumsum(RLRdata2020$fraction)
RLRdata2020$ymin = c(0, head(RLRdata2020)$ymax, n=-1)
View(RLRdata2020)
RLRdata2020$fraction = RLRdata2020$count / sum(RLRdata2020$count)
RLRdata2020$percentage = RLRdata2020$count / sum(RLRdata2020$count) * 100
RLRdata2020$ymax = cumsum(RLRdata2020$fraction)
RLRdata2020$ymin = c(0, head(RLRdata2020$ymax, n=-1))
#Rounding up
RLRdata2020 <- round_df(RLRdata2020, 2)
# Specify what the legend should say
Type_of_Tweet <- paste(RLRdata2020$category, RLRdata2020$percentage, "%")
ggplot(RLRdata2020, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Type_of_Tweet)) +
geom_rect() +
coord_polar(theta="y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "right")
#Adding columns
RLRdata2021$fraction = RLRdata2021$count / sum(RLRdata2021$count)
RLRdata2021$percentage = RLRdata2021$count / sum(RLRdata2021$count) * 100
RLRdata2021$ymax = cumsum(RLRdata2021$fraction)
RLRdata2021$ymin = c(0, head(RLRdata2021$ymax, n=-1))
#Rounding up
RLRdata2021 <- round_df(RLRdata2021, 2)
# Specify what the legend should say
Type_of_Tweet <- paste(RLRdata2021$category, RLRdata2021$percentage, "%")
ggplot(RLRdata2021, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Type_of_Tweet)) +
geom_rect() +
coord_polar(theta="y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "right")
