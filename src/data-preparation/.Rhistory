)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blmdata)
dir.create('../../datasets', recursive= TRUE)
files = list(
c(url = 'https://www.dropbox.com/s/7ywlwmynitdb2rr/BLM2020_Dataset.csv?dl=1', target =
'BLM2020_dataset.csv'),
c(url = 'https://www.dropbox.com/s/glpv88v6hb0u4j1/BLM2021_Dataset.csv?dl=1', target =
'BLM2021_dataset.csv'))
library(data.table)
for (i in files) {
print(i)
#i['url']
#i['target']
blm_data <- read.csv(i['url'],  sep = '\t', na.strings = c("", "NA"))
write.table(blm_data, paste0('../../datasets/', i['target']))
}
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
fread(
fn
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Get a first look of the data
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
# Make the Time variable readable
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime))
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern="\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="â€¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â˜… ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃ©", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="â€¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Œ", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blmdata)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
fread(
fn
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Get a first look of the data
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
# Make the Time variable readable
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime))
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern="\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="â€¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â˜… ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃ©", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="â€¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Œ", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
fread(
fn
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Get a first look of the data
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
# Make the Time variable readable
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime))
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern="\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="â€¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â˜… ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="â€¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Œ", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blmdata)
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
fread(
fn
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Get a first look of the data
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
# Make the Time variable readable
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime))
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern="\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="â€¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â˜… ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃ©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "˜‰", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "¤”˜‚¤£‘Š", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â€™", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="â€¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Œ", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blmdata)
prepared_data[[1]]
prepared_data[[2]]
# remove weird characters (rendered) content tweet and user description
weird <- c("\r\n","â€¢","â˜… ", "ðŸ","ðŸ¤", "Ã", "©","HÃ©", "˜‰","¤”˜‚¤£‘Š","â€™" )
blmdata$text <- gsub(x=blmdata$text, pattern= weird,replacement="", fixed = T)
dir.create('../../datasets', recursive= TRUE)
files = list(
c(url = 'https://www.dropbox.com/s/7ywlwmynitdb2rr/BLM2020_Dataset.csv?dl=1', target =
'BLM2020_dataset.csv'),
c(url = 'https://www.dropbox.com/s/glpv88v6hb0u4j1/BLM2021_Dataset.csv?dl=1', target =
'BLM2021_dataset.csv'))
library(data.table)
for (i in files) {
print(i)
#i['url']
#i['target']
blm_data <- read.csv(i['url'],  sep = '\t', na.strings = c("", "NA"))
write.table(blm_data, paste0('../../datasets/', i['target']))
}
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
fread(
fn
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Get a first look of the data
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
# Make the Time variable readable
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime))
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern="\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="â€¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â˜… ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃ©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "˜‰", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "¤”˜‚¤£‘Š", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â€™", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="â€¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Œ", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blmdata)
rm(blmdata)
prepared_data[[1]]
prepared_data[[2]]
# Preclean data 2020
#-------------------------------------------------------------------------------
# Make current directory the working directory
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Load packages
#install.packages('textclean')
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
fread(
fn
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Get a first look of the data
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
# Make the Time variable readable
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime))
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern="\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="â€¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â˜… ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "ðŸ¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃ©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "˜‰", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "¤”˜‚¤£‘Š", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "â€™", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="\r\n",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="â€¢",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "â˜… ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "ðŸ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="â€¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "â˜… ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "ðŸ¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Œ", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(prepared_data, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
rm(blmdata)
prepared_data[[1]]
prepared_data[[2]]
write.table(prepared_data, paste0('../../gen/data-preparation/temp/', extracted_filename))
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
