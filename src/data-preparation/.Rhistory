# See the type of data of the variables
glimpse(blmdata)
# TO DO: and also can you look at the rendered_tweet and removing the weird characters?
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make a variable
blmdata$year_tweeted <- substring(blmdata$date,1,4)
# Separate the date and the time of user creation into 2 variables
blmdata$user_created_date <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 1)
blmdata$user_created_time <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 2)
# The data is a character and needs to be converted into a date variable
blmdata$user_created_date <- as.Date(blmdata$user_created_date, format = c("%Y-%m-%d"))
# Make the time of user creation readable
blmdata$user_created_time <- gsub(x=blmdata$user_created_time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make it into a variable
blmdata$year_created <- substring(blmdata$user_created_date,1,4)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime, user_created))
# Make sure that the other variables are measured correctly
blmdata$retweeted_tweet <- as.integer(blmdata$retweeted_tweet)
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern= "\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="Ã¢â¬Â¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã¢Ëâ¦ ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã°Å¸", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã°Å¸Â¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Â©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃÂ©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ëâ°", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Â¤âËâÂ¤Â£âÅ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã¢â¬â¢", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "\r\n", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ã", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "³", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ª", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¨", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "€", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "˜", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "™", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ã", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&gt;", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ð", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ÿ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¤", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "®", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "€", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¬", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¦", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "©", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "®", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ðŸ˜‰", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "œ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Š", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¾", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ï", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¸", replacement = "", fixed = T)
replace_contraction(blmdata$rendered_content)
replace_emoticon(blmdata$redered_content)
replace_incomplete(blmdata, ".")
check_text(blmdata$rendered_content, file = NULL, checks = NULL, n = 10)
blmdata$rendered_content <- replace(blmdata$rendered_content, c( "¤", "®", "Â", "€", "¡", "¬", "", "¦", "©", "®", "ðŸ˜‰", "œ", "Š", "", "¾", "¡", "ï", "¸"), "")
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="Ã¢â¬Â¢",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "Ã¢Ëâ¦ ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã°Å¸", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Â¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃÂ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Â©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="Ã¢â¬Â¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "Ã¢Ëâ¦ ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã°Å¸", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã°Å¸Â¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Â©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã¢", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â¢", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Å", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "", replacement = "", fixed = T)
#install.packages('textclean')
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
library("textclean")
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
read.csv(
fn, sep = ',' , na.string = c(" ", "NA")
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Set the NA's right
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
blmdata$location <- replace(blmdata$location, blmdata$location == "", NA)
blmdata$user_description <- replace(blmdata$user_description, blmdata$user_description == "", NA)
blmdata$quoted_tweet <- replace(blmdata$quoted_tweet, blmdata$quoted_tweet == "", NA)
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# TO DO: and also can you look at the rendered_tweet and removing the weird characters?
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make a variable
blmdata$year_tweeted <- substring(blmdata$date,1,4)
# Separate the date and the time of user creation into 2 variables
blmdata$user_created_date <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 1)
blmdata$user_created_time <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 2)
# The data is a character and needs to be converted into a date variable
blmdata$user_created_date <- as.Date(blmdata$user_created_date, format = c("%Y-%m-%d"))
# Make the time of user creation readable
blmdata$user_created_time <- gsub(x=blmdata$user_created_time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make it into a variable
blmdata$year_created <- substring(blmdata$user_created_date,1,4)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime, user_created))
# Make sure that the other variables are measured correctly
blmdata$retweeted_tweet <- as.integer(blmdata$retweeted_tweet)
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern= "\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="Ã¢â¬Â¢",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã¢Ëâ¦ ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã°Å¸", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã°Å¸Â¤", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Â©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "HÃÂ©", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ëâ°", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Â¤âËâÂ¤Â£âÅ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "Ã¢â¬â¢", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "\r\n", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ã", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "³", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ª", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¨", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "€", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "˜", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "™", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ã", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&gt;", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ð", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ÿ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¤", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "®", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "€", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¬", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¦", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "©", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "®", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ðŸ˜‰", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "œ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Š", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¾", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ï", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¸", replacement = "", fixed = T)
replace_contraction(blmdata$rendered_content)
replace_emoticon(blmdata$redered_content)
replace_incomplete(blmdata, ".")
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="Ã¢â¬Â¢",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "Ã¢Ëâ¦ ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã°Å¸", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Â¤", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "HÃÂ©", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Ã", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "Â©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="Ã¢â¬Â¢",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "Ã¢Ëâ¦ ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã°Å¸", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã°Å¸Â¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Â©", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Ã¢", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "â¢", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "Å", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blmdata)
View(blmdata)
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
library("textclean")
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
read.csv(
fn, sep = ',' , na.string = c(" ", "NA")
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Set the NA's right
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
blmdata$location <- replace(blmdata$location, blmdata$location == "", NA)
blmdata$user_description <- replace(blmdata$user_description, blmdata$user_description == "", NA)
blmdata$quoted_tweet <- replace(blmdata$quoted_tweet, blmdata$quoted_tweet == "", NA)
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# TO DO: and also can you look at the rendered_tweet and removing the weird characters?
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make a variable
blmdata$year_tweeted <- substring(blmdata$date,1,4)
# Separate the date and the time of user creation into 2 variables
blmdata$user_created_date <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 1)
blmdata$user_created_time <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 2)
# The data is a character and needs to be converted into a date variable
blmdata$user_created_date <- as.Date(blmdata$user_created_date, format = c("%Y-%m-%d"))
# Make the time of user creation readable
blmdata$user_created_time <- gsub(x=blmdata$user_created_time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make it into a variable
blmdata$year_created <- substring(blmdata$user_created_date,1,4)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime, user_created))
# Make sure that the other variables are measured correctly
blmdata$retweeted_tweet <- as.integer(blmdata$retweeted_tweet)
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern= "\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="?〡Ⅹ珍?",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?〡Ⅹ? ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?冕?", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?冕蜆?", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "H??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?Ⅹ?", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?勻〡〡勻?璽??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?〡Ⅹ珍Ⅹ?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "\r\n", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "糧", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "穠", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "穡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "璽", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&gt;", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簸", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "顫", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "瞻", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簧", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "癒", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "竅", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "礎", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "穢", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簧", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簸顫??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "職", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簿", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "繡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "翻", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "禮", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簡", replacement = "", fixed = T)
#replace data that is retreived the wrong way
replace_contraction(blmdata$rendered_content)
replace_emoticon(blmdata$redered_content)
replace_incomplete(blmdata, ".")
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="?〡Ⅹ珍?",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "?〡Ⅹ礎 ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "?冕?", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "??", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "H??", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "??", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="?〡Ⅹ珍?",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "?〡Ⅹ? ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "?冕?", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "?冕蜆?", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "璽瞽", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
View(blm_data)
View(data_blm)
#-------------------------------------------------------------------------------
# Preclean data 2020
#-------------------------------------------------------------------------------
# Make current directory the working directory
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Load packages
#install.packages('textclean')
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
library("textclean")
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
read.csv(
fn, sep = ',' , na.string = c(" ", "NA")
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Set the NA's right
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
blmdata$location <- replace(blmdata$location, blmdata$location == "", NA)
blmdata$user_description <- replace(blmdata$user_description, blmdata$user_description == "", NA)
blmdata$quoted_tweet <- replace(blmdata$quoted_tweet, blmdata$quoted_tweet == "", NA)
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# TO DO: and also can you look at the rendered_tweet and removing the weird characters?
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make a variable
blmdata$year_tweeted <- substring(blmdata$date,1,4)
# Separate the date and the time of user creation into 2 variables
blmdata$user_created_date <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 1)
blmdata$user_created_time <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 2)
# The data is a character and needs to be converted into a date variable
blmdata$user_created_date <- as.Date(blmdata$user_created_date, format = c("%Y-%m-%d"))
# Make the time of user creation readable
blmdata$user_created_time <- gsub(x=blmdata$user_created_time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make it into a variable
blmdata$year_created <- substring(blmdata$user_created_date,1,4)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime, user_created))
# Make sure that the other variables are measured correctly
blmdata$retweeted_tweet <- as.integer(blmdata$retweeted_tweet)
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(x=blmdata$text, pattern= "\r\n",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern="?〡Ⅹ珍?",replacement="", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?〡Ⅹ? ", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?冕?", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?冕蜆?", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "H??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?Ⅹ?", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?勻〡〡勻?璽??", replacement = "", fixed = T)
blmdata$text <- gsub(x=blmdata$text, pattern = "?〡Ⅹ珍Ⅹ?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "\r\n", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "糧", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "穠", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "穡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "璽", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&gt;", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簸", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "顫", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "瞻", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簧", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "?", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "癒", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "竅", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "礎", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "穢", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簧", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簸顫??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "職", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簿", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "繡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "??", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "翻", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "禮", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簡", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "簡", replacement = "", fixed = T)
#replace data that is retreived the wrong way
replace_contraction(blmdata$rendered_content)
replace_emoticon(blmdata$redered_content)
replace_incomplete(blmdata, ".")
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern="?〡Ⅹ珍?",replacement="", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_content, pattern= "?〡Ⅹ礎 ", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "?冕?", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "??", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "H??", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "??", replacement = "", fixed = T)
#blmdata$rendered_content <- gsub(x=blmdata$rendered_Content, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="\r\n",replacement="", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern="?〡Ⅹ珍?",replacement="", fixed = T)
blmdata$user_description<- gsub(x=blmdata$user_description, pattern= "?〡Ⅹ? ", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "?冕?", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "?冕蜆?", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "璽瞽", replacement = "", fixed = T)
blmdata$user_description <- gsub(x=blmdata$user_description, pattern= "??", replacement = "", fixed = T)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
