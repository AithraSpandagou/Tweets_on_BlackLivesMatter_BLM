blm_merged$user_created <- gsub(x=blm_merged$user_created, pattern="+00:00",replacement="",fixed=T)
blm_merged$user_created <- sapply(strsplit(as.character(blm_merged$user_created), " "), "[", 1)
blm_merged$user_created_time <- sapply(strsplit(as.character(blm_merged$user_created), " "), "[", 2)
blm_merged$user_created <- as.Date(blm_merged$user_created, format = c("%Y-%m-%d"))
# Set date into as.Date
blm_merged$data <- as.Date(blm_merged$date)
# set variables with counting numbers into integers
blm_merged$user_amount_followers <- as.integer(blm_merged$user_amount_followers)
blm_merged$user_amount_friends <- as.integer(blm_merged$user_amount_friends)
blm_merged$user_amount_status <- as.integer(blm_merged$user_amount_status)
blm_merged$user_listed_count <- as.integer(blm_merged$user_listed_count)
blm_merged$user_media_count <- as.integer(blm_merged$user_media_count)
blm_merged$quote_count <- as.integer(blm_merged$quote_count)
blm_merged$retweeted_tweet <- as.integer(blm_merged$retweeted_tweet)
# add column with year of tweets
blm_merged$year <- format(blm_merged$data, format = "%Y")
## --------------- end cleaning: write over in csv file -------------------##
write.csv(blm_merged, '../../gen/data-preparation/merging.csv')
blm2020<-read.csv('../../gen/data-preparation/temp/BLM2020_dataset.csv', sep = '', na.strings=c("", "NA"))
blm_merged<- rbind(blm2020, blm2021)
install.packages(plyr)
library(plyr)
blm_merged<- rbind(blm2020, blm2021)
library(dplyr)
blm_merged<- rbind(blm2020, blm2021)
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"))
blm2020<-read.csv('../../gen/data-preparation/temp/BLM2020_dataset.csv', sep = '', na.strings=c("", "NA"))
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"))
library(plyr)
library(dplyr)
blm2020<-read.csv('../../gen/data-preparation/temp/BLM2020_dataset.csv', sep = '', na.strings=c("", "NA"))
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"))
dir.create('../../datasets', recursive= TRUE)
files = list(
c(url = 'https://www.dropbox.com/s/7ywlwmynitdb2rr/BLM2020_Dataset.csv?dl=1', target =
'BLM2020_dataset.csv'),
c(url = 'https://www.dropbox.com/s/glpv88v6hb0u4j1/BLM2021_Dataset.csv?dl=1', target =
'BLM2021_dataset.csv'))
library(data.table)
for (i in files) {
print(i)
#i['url']
#i['target']
blm_data <- read.csv(i['url'], sep = '\t', na.string = c(" ", "NA"))
write.csv(blm_data, paste0('../../datasets/', i['target']), quote = TRUE, fileEncoding = "")
}
#-------------------------------------------------------------------------------
# Preclean data 2020
#-------------------------------------------------------------------------------
# Make current directory the working directory
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Load packages
#install.packages('textclean')
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
library("textclean")
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
read.csv(
fn, sep = ',' , na.string = c(" ", "NA")
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Set the NA's right
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
blmdata$location <- replace(blmdata$location, blmdata$location == "", NA)
blmdata$user_description <- replace(blmdata$user_description, blmdata$user_description == "", NA)
blmdata$quoted_tweet <- replace(blmdata$quoted_tweet, blmdata$quoted_tweet == "", NA)
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make a variable
blmdata$year_tweeted <- substring(blmdata$date,1,4)
# Separate the date and the time of user creation into 2 variables
blmdata$user_created_date <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 1)
blmdata$user_created_time <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 2)
# The data is a character and needs to be converted into a date variable
blmdata$user_created_date <- as.Date(blmdata$user_created_date, format = c("%Y-%m-%d"))
# Make the time of user creation readable
blmdata$user_created_time <- gsub(x=blmdata$user_created_time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make it into a variable
blmdata$year_created <- substring(blmdata$user_created_date,1,4)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime, user_created))
# Make sure that the other variables are measured correctly
blmdata$retweeted_tweet <- as.integer(blmdata$retweeted_tweet)
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(blmdata$text, pattern = "\r\n",replacement= "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "©", replacement= "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¦", replacement= "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "f", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ð", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "Y", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "~", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¯", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ª", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¸", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "&gt;", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "â", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¤;", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ï", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "T", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "«", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¨", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "'ª", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¢", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "o;", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "®", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "â", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "Ÿ", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "˜", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "œ", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "½", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "™", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ˆ", replacement = "&", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "\r\n", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "©", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¦", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ã", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "f", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ð", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Y", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "~", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¯", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ª", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¸", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&gt;", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¤", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ï", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "T", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "«", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¨", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&amp;", replacement = "&", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¢", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "'ª", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "o", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "®", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ÿ", replacement = "&", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "˜", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "œ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "½", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "™", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ˆ", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "\r\n", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "©", replacement= "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¦", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "f", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ð", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "Y", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "~", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¯", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ª", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¸", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "&gt;", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ï", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "T", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "«", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¨", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "&amp;", replacement = "&", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¢", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "'ª", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "o", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "®", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "Ÿ", replacement = "&", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "˜", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "œ", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "½", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ˆ", replacement = "", fixed = T)
#replace data that is retreived the wrong way
replace_contraction(blmdata$rendered_content)
replace_emoticon(blmdata$redered_content)
replace_incomplete(blmdata, ".")
# Transform the tweet_id and user_id into fully written numbers
blmdata$tweet_id_full <- format(blmdata$tweet_id, scientific = FALSE)
blmdata$user_id_full <- format(blmdata$tweet_id, scientific = FALSE)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
rm(blmdata)
prepared_data[[1]]
prepared_data[[2]]
library(plyr)
library(dplyr)
blm2020<-read.csv('../../gen/data-preparation/temp/BLM2020_dataset.csv', sep = '', na.strings=c("", "NA"))
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"))
dir.create('../../datasets', recursive= TRUE)
files = list(
c(url = 'https://www.dropbox.com/s/7ywlwmynitdb2rr/BLM2020_Dataset.csv?dl=1', target =
'BLM2020_dataset.csv'),
c(url = 'https://www.dropbox.com/s/glpv88v6hb0u4j1/BLM2021_Dataset.csv?dl=1', target =
'BLM2021_dataset.csv'))
library(data.table)
for (i in files) {
print(i)
#i['url']
#i['target']
blm_data <- read.csv(i['url'], sep = '\t', na.string = c(" ", "NA"))
write.csv(blm_data, paste0('../../datasets/', i['target']), quote = TRUE, fileEncoding = "")
}
#-------------------------------------------------------------------------------
# Preclean data 2020
#-------------------------------------------------------------------------------
# Make current directory the working directory
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Load packages
#install.packages('textclean')
library(data.table)
library(dplyr)
library(tidyr)
library(textclean)
library("textclean")
# install.packages(pandas)
# library(pandas)
# download data
filenames = c('../../datasets/BLM2020_dataset.csv',
'../../datasets/BLM2021_dataset.csv')
data_blm = lapply(filenames,
function(fn) {
read.csv(
fn, sep = ',' , na.string = c(" ", "NA")
)
})
# Loop through all of the data
dir.create('../../gen/data-preparation/temp', recursive= TRUE)
prepared_data <- list()
for (i in seq(along=data_blm)) {
print(i)
blmdata = data_blm[[i]]
fn = filenames[i]
extracted_filename = rev(strsplit(fn, '/')[[1]])[1]
# Set the NA's right
blmdata$retweeted_tweet[is.na(blmdata$retweeted_tweet)] <- 0
blmdata$quoted_tweet[is.na(blmdata$quoted_tweet)] <- "No"
blmdata$location <- replace(blmdata$location, blmdata$location == "", NA)
blmdata$user_description <- replace(blmdata$user_description, blmdata$user_description == "", NA)
blmdata$quoted_tweet <- replace(blmdata$quoted_tweet, blmdata$quoted_tweet == "", NA)
# Remove duplicates with the distinct function
sum(duplicated(blmdata))
blmdata %>% distinct(blmdata$tweet_id)
# See the type of data of the variables
glimpse(blmdata)
# Separate the date and the time into 2 variables
blmdata$date <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 1)
blmdata$time <- sapply(strsplit(as.character(blmdata$datetime), " "), "[", 2)
#see the class of the date
class(blmdata$date)
# The data is a character and needs to be converted into a date variable
blmdata$date <- as.Date(blmdata$date, format = c("%Y-%m-%d"))
blmdata$time <- gsub(x=blmdata$time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make a variable
blmdata$year_tweeted <- substring(blmdata$date,1,4)
# Separate the date and the time of user creation into 2 variables
blmdata$user_created_date <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 1)
blmdata$user_created_time <- sapply(strsplit(as.character(blmdata$user_created), " "), "[", 2)
# The data is a character and needs to be converted into a date variable
blmdata$user_created_date <- as.Date(blmdata$user_created_date, format = c("%Y-%m-%d"))
# Make the time of user creation readable
blmdata$user_created_time <- gsub(x=blmdata$user_created_time, pattern="+00:00",replacement="",fixed=T)
# Extract the year and make it into a variable
blmdata$year_created <- substring(blmdata$user_created_date,1,4)
# Remove the Datetime variable and create a new dataframe
blmdata = subset(blmdata, select = -c(datetime, user_created))
# Make sure that the other variables are measured correctly
blmdata$retweeted_tweet <- as.integer(blmdata$retweeted_tweet)
# remove weird characters (rendered) content tweet and user description
blmdata$text <- gsub(blmdata$text, pattern = "\r\n",replacement= "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "©", replacement= "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¦", replacement= "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "Ã", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "f", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ð", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "Y", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "~", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¯", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ª", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¸", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "&gt;", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "â", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¤;", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ï", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "T", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "«", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¨", replacement = "", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "'ª", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "¢", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "o;", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "®", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "â", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "Ÿ", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "˜", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "œ", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "½", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "™", replacement = "&", fixed = T)
blmdata$text <- gsub(blmdata$text, pattern = "ˆ", replacement = "&", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "\r\n", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "©", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¦", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ã", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "f", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ð", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Y", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "~", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¯", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ª", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¸", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&gt;", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¤", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ï", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "T", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "«", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¨", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "&amp;", replacement = "&", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "¢", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "'ª", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "o", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "®", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "â", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "Ÿ", replacement = "&", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "˜", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "œ", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "½", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "™", replacement = "", fixed = T)
blmdata$rendered_content <- gsub(blmdata$rendered_content, pattern = "ˆ", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "\r\n", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "©", replacement= "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¦", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "Ã", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "f", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ð", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "Y", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "~", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¯", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ª", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¸", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "&gt;", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¤", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ï", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "T", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "«", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¨", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "&amp;", replacement = "&", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "¢", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "'ª", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "o", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "®", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "â", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "Ÿ", replacement = "&", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "˜", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "œ", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "½", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "™", replacement = "", fixed = T)
blmdata$user_description <- gsub(blmdata$user_description, pattern = "ˆ", replacement = "", fixed = T)
#replace data that is retreived the wrong way
replace_contraction(blmdata$rendered_content)
replace_emoticon(blmdata$redered_content)
replace_incomplete(blmdata, ".")
# Transform the tweet_id and user_id into fully written numbers
blmdata$tweet_id_full <- format(blmdata$tweet_id, scientific = FALSE)
blmdata$user_id_full <- format(blmdata$tweet_id, scientific = FALSE)
# clean source attribute to useful
html_tags <- c(
"<bold>Random</bold> text with symbols: &nbsp; &lt; &gt; &amp; &quot; &apos;",
"<p>More text</p> &cent; &pound; &yen; &euro; &copy; &reg;"
)
blmdata$source_tweet<- replace_html(blmdata$source_tweet)
prepared_data[[i]] <- blmdata
write.table(blmdata, paste0('../../gen/data-preparation/temp/', extracted_filename))
}
rm(blmdata)
prepared_data[[1]]
prepared_data[[2]]
# load cleaned data
library(plyr)
library(dplyr)
blm2020<-read.csv('../../gen/data-preparation/temp/BLM2020_dataset.csv', sep = '', na.strings=c("", "NA"))
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"))
# merge data
blm_merged<- rbind(blm2020, blm2021)
##  ----------------------cleaning merged data; remove first column, set date as.Date and add column with year --------------------------- ##
# remove first column
blm_merged <- subset(blm_merged, select = -X)
# set user_created variable into Y-m-d
blm_merged$user_created <- gsub(x=blm_merged$user_created, pattern="+00:00",replacement="",fixed=T)
blm_merged$user_created <- sapply(strsplit(as.character(blm_merged$user_created), " "), "[", 1)
blm_merged$user_created_time <- sapply(strsplit(as.character(blm_merged$user_created), " "), "[", 2)
blm_merged$user_created <- as.Date(blm_merged$user_created, format = c("%Y-%m-%d"))
# Set date into as.Date
blm_merged$data <- as.Date(blm_merged$date)
# set variables with counting numbers into integers
blm_merged$user_amount_followers <- as.integer(blm_merged$user_amount_followers)
blm_merged$user_amount_friends <- as.integer(blm_merged$user_amount_friends)
blm_merged$user_amount_status <- as.integer(blm_merged$user_amount_status)
blm_merged$user_listed_count <- as.integer(blm_merged$user_listed_count)
blm_merged$user_media_count <- as.integer(blm_merged$user_media_count)
blm_merged$quote_count <- as.integer(blm_merged$quote_count)
blm_merged$retweeted_tweet <- as.integer(blm_merged$retweeted_tweet)
# add column with year of tweets
blm_merged$year <- format(blm_merged$data, format = "%Y")
## --------------- end cleaning: write over in csv file -------------------##
write.csv(blm_merged, '../../gen/data-preparation/merging.csv')
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"), row.names=NULL)
blm_merged<- rbind(blm2020, blm2021)
blm2020<-read.csv('../../gen/data-preparation/temp/BLM2020_dataset.csv', sep = '', na.strings=c("", "NA"), row.names=NULL)
blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"), row.names=NULL)
blm_merged<- rbind(blm2020, blm2021)
blm_merged <- subset(blm_merged, select = -X)
blm_merged$user_created <- gsub(x=blm_merged$user_created, pattern="+00:00",replacement="",fixed=T)
blm_merged$user_created <- sapply(strsplit(as.character(blm_merged$user_created), " "), "[", 1)
blm_merged$user_created_time <- sapply(strsplit(as.character(blm_merged$user_created), " "), "[", 2)
blm_merged$user_created <- as.Date(blm_merged$user_created, format = c("%Y-%m-%d"))
# Set date into as.Date
blm_merged$data <- as.Date(blm_merged$date)
# set variables with counting numbers into integers
blm_merged$user_amount_followers <- as.integer(blm_merged$user_amount_followers)
blm_merged$user_amount_friends <- as.integer(blm_merged$user_amount_friends)
blm_merged$user_amount_status <- as.integer(blm_merged$user_amount_status)
blm_merged$user_listed_count <- as.integer(blm_merged$user_listed_count)
blm_merged$user_media_count <- as.integer(blm_merged$user_media_count)
blm_merged$quote_count <- as.integer(blm_merged$quote_count)
blm_merged$retweeted_tweet <- as.integer(blm_merged$retweeted_tweet)
# add column with year of tweets
blm_merged$year <- format(blm_merged$data, format = "%Y")
## --------------- end cleaning: write over in csv file -------------------##
write.csv(blm_merged, '../../gen/data-preparation/merging.csv')
blm_merged$user_amount_followers <- as.integer(blm_merged$user_amount_followers, na.strings = "NA")
blm_merged$user_amount_followers <- as.integer(blm_merged$user_amount_followers, na.strings = "NA")
blm_merged$user_amount_followers <- as.integer(blm_merged$user_amount_followers, na.strings = "NA")
blm_merged$user_amount_friends <- as.integer(blm_merged$user_amount_friends, na.strings = "NA")
blm_merged$user_amount_status <- as.integer(blm_merged$user_amount_status, na.strings = "NA")
blm_merged$user_listed_count <- as.integer(blm_merged$user_listed_count, na.strings = "NA")
blm_merged$user_media_count <- as.integer(blm_merged$user_media_count, na.strings = "NA")
blm_merged$quote_count <- as.integer(blm_merged$quote_count, na.strings = "NA")
blm_merged$retweeted_tweet <- as.integer(blm_merged$retweeted_tweet, na.strings = "NA")
write.csv(blm_merged, '../../gen/data-preparation/merging.csv')
library(rtweet)
library(tidyr)
library(ggplot.multistats)
library(ggplot2)
library(forestmangr)
library(syuzhet)
library(tidyverse)
library(readxl) # read excel
library(tibble) # tibble dataframe
library(dplyr) # piping
library(stringr) # character manipulation
library(tidytext)
library(tokenizers)
library(stopwords)
library(lobstr)
library(glue)
blm_merged<-read.csv('../../gen/data-preparation/merging.csv', sep = ',', na.strings=c("", "NA"))
#blm2021<-read.csv('../../gen/data-preparation/temp/BLM2021_dataset.csv', sep = '', na.strings=c("", "NA"))
#Retweet
RLR <- function(year){
for (i in year){
retweet <- (sum(blm_merged[blm_merged$year == year,]$retweet, na.rm = T))
like <- (sum(blm_merged[blm_merged$year == year,]$like, na.rm = T))
reply <- (sum(blm_merged[blm_merged$year == year,]$reply, na.rm = T))
}
RLRdata <- data.frame(category=c("Retweet", "Like", "Reply"), count = c(retweet, like, reply))
return(RLRdata)
}
RLRdata2020 <- RLR(2020)
RLRdata2020 <- RLR$2020
RLRdata2020 <- RLR(2020)
